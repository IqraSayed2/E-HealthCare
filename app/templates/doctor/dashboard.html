{% extends "base.html" %}
{% block title %}Doctor Dashboard{% endblock %}
{% block content %}

<div class="d-dash-wrapper">

  <!-- Welcome Section -->
  <div class="d-dash-welcome-section">
    <div class="d-dash-welcome-header">
      <div class="d-dash-welcome-info">
        <h1>Welcome back, Dr. {{ current_user.name }}</h1>
        <p>
          {{ today_appointments|length }} appointments scheduled today
        </p>
      </div>

      <div class="d-dash-welcome-actions">
        <a href="{{ url_for('doctor.availability') }}" class="d-dash-welcome-btn">
          <i class="fas fa-calendar-plus"></i>
          Add Availability
        </a>
        <a href="{{ url_for('doctor.profile') }}" class="d-dash-welcome-btn">
          <i class="fas fa-user"></i>
          My Profile
        </a>
      </div>
    </div>
  </div>

  <!-- Stats Grid -->
  <div class="d-dash-stats-grid">

    <div class="d-dash-stat-card">
      <div class="d-dash-stat-header">
        <div class="d-dash-stat-icon appointments">
          <i class="far fa-calendar-check"></i>
        </div>
      </div>
      <div class="d-dash-stat-label">Total Appointments</div>
      <div class="d-dash-stat-value">{{ total_appointments }}</div>
    </div>

    <div class="d-dash-stat-card">
      <div class="d-dash-stat-header">
        <div class="d-dash-stat-icon pending">
          <i class="fas fa-clock"></i>
        </div>
      </div>
      <div class="d-dash-stat-label">Pending Requests</div>
      <div class="d-dash-stat-value">{{ pending_appointments }}</div>
    </div>

    <div class="d-dash-stat-card">
      <div class="d-dash-stat-header">
        <div class="d-dash-stat-icon earnings">
          <i class="fas fa-check-circle"></i>
        </div>
      </div>
      <div class="d-dash-stat-label">Completed</div>
      <div class="d-dash-stat-value">{{ completed_appointments }}</div>
    </div>

  </div>

  <!-- Main Content Grid -->
  <div class="d-dash-content-grid">

    <!-- LEFT COLUMN -->
    <div>

      <!-- Today's Appointments -->
      <div class="d-dash-content-card mb-4">
        <div class="d-dash-card-header">
          <h2 class="d-dash-card-title">
            <i class="fas fa-calendar-day"></i>
            Today's Appointments
          </h2>
        </div>

        {% if today_appointments %}
          {% for appt in today_appointments %}
          <div class="d-dash-appointment-card">
            <div class="d-dash-appointment-time">
              <div class="d-dash-time-hour">{{ appt.time }}</div>
            </div>

            <div class="d-dash-appointment-info">
              <div class="d-dash-patient-name">
                {{ appt.patient.user.name }}
              </div>

              <div class="d-dash-appointment-meta">
                <span class="d-dash-meta-tag">
                  <i class="fas fa-calendar"></i>
                  {{ appt.date }}
                </span>

                <span class="d-dash-status-badge {{ appt.status }}">
                  {{ appt.status|capitalize }}
                </span>
              </div>

              <div class="d-dash-appointment-actions">
                {% if appt.status == "pending" %}
                  <a href="{{ url_for('doctor.accept', id=appt.id) }}"
                     class="d-dash-action-btn primary">
                    <i class="fas fa-check"></i> Accept
                  </a>
                {% endif %}
              </div>
            </div>
          </div>
          {% endfor %}
        {% else %}
          <div class="d-dash-empty-state">
            <div class="d-dash-empty-icon">
              <i class="far fa-calendar-times"></i>
            </div>
            <p>No appointments today</p>
          </div>
        {% endif %}
      </div>

    </div>

    <!-- RIGHT COLUMN -->
    <div>

      <!-- Summary Card -->
      <div class="d-dash-content-card">
        <div class="d-dash-card-header">
          <h2 class="d-dash-card-title">
            <i class="fas fa-info-circle"></i>
            Quick Summary
          </h2>
        </div>

        <p><strong>Total Appointments:</strong> {{ total_appointments }}</p>
        <p><strong>Pending:</strong> {{ pending_appointments }}</p>
        <p><strong>Completed:</strong> {{ completed_appointments }}</p>

      </div>

    </div>

  </div>
</div>

{% endblock %}
